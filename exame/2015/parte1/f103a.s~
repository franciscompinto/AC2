.equ 	SFR_BASE_HI,0xBF88
.equ 	TRISE,0x6100
.equ	PORTE,0X6110
.equ 	LATE,0x6120

.equ 	TRISD,0x60C0
.equ	PORTD,0X60D0
.equ 	LATD,0x60E0
	
	.data
	.text
	.globl main

main:	lui $t0,SFR_BASE_HI 	#declaracao dos portos
	lw $t1,TRISE($t0)	#porto de estada
	ori $t1,$t1,0x00F0
	sw $t1,TRISE($t0)

	lw $t5,TRISD($t0)	#porto de saida
	andi $t5,$t5,0xF00f
	sw $t5,TRISD($t0)


loop:	lw $t1,PORTE($t0)	#LEITURA DO PORTO DE ENTREADA
	lw $t5,PORTD($t0)


	andi $t2,$t1,0x00F0
	srl $t3, $t2, 4
	srl $t4, $t2, 7
	andi $t3, $t3,0x0007
	andi $t4, $t4,0x0001

if:	
	beq $t4, 0,endif	#

	not $t3, $t3
	andi $t3, $t3,0x0007

endif:
	

	li $t7,0 	#int i
	li $t6,1 	#mul=1
for:
	beq $t7, $t3, endfor

	mul $t6, $t6, 2		#mul *=2
	add $t7, $t7, 1		#i++
	j for
endfor:

	
	addi $t6, $t6, -1	#mul= mul -1
	#esto e devido a ser usado o porto D4 a D11
	sll $t6, $t6, 4		#mul<< 4
 
if2:	
	beq $t4, 0,endif2	#

	
	ori $t6, $t6,0x0800

endif2:
	

		

	
	andi $t5,$t5,0xF00F
	or  $t5, $t5, $t6
	sw $t5, LATD($t0)


	move $a0,$t6
	li $a1, 0x000C0002
	li $v0, 6
	syscall
	
	la $a0, '\n'
	li $v0, 3
	syscall

	
		
	j loop
	jr $ra
